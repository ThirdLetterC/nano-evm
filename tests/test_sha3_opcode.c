#include "test_helpers.h"

void test_sha3_opcode() {
  EVM_State vm;
  uint8_t *code = nullptr;

  EVM_Status status = execute_hex("6000600020", 36, &vm, &code);
  assert(status == EVM_OK);
  assert(vm.gas_remaining == 0);

  static constexpr uint8_t empty_keccak[32] = {
      0xc5, 0xd2, 0x46, 0x01, 0x86, 0xf7, 0x23, 0x3c, 0x92, 0x7e, 0x7d,
      0xb2, 0xdc, 0xc7, 0x03, 0xc0, 0xe5, 0x00, 0xb6, 0x53, 0xca, 0x82,
      0x27, 0x3b, 0x7b, 0xfa, 0xd8, 0x04, 0x5d, 0x85, 0xa4, 0x70};
  assert_top_bytes32(&vm, empty_keccak);
  cleanup(&vm, code);
}
